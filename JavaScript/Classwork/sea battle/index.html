<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link rel="stylesheet" href="css/style.css">
  <title>SeaBattle</title>
</head>

<body>

  <div id='app'></div>

  <!--<br>-->
  <!--<input type=button value='Стартовый экран' onclick='switchToStartScreePage()'>-->
  <!--<br>-->


  <!--<br>-->
  <!--<input type=button value='Игра' onclick='switchToGamePage()'>-->

  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>

    "use strict";

    //render function

    const IMG_URL = 'img/'; //глобальная переменная

    const setBG = imgName => { 
      const body = document.querySelector('body');
      body.style.backgroundImage = `url(${IMG_URL}${imgName})`
    }

    const renderStartScreen = () => { //функция воспроизводит стартовый экран
      setBG('artwork-battleships-british-fleets.jpg')
        //функция возвращает кусок вёрстки
        //class - тип кнопки из materialize
      return ` 
        <h2>Sea Battle !!!</h2>
        <h3>Присоединяйся к сражениям в морях и океанах!</h3>
        <input type="button" class="waves-effect waves-light btn-large" value="Играть самому" onclick="switchToSelf('1.js')">
        <input type="button" class="waves-effect waves-light btn-large" value="Играть против компьютера" onclick="switchToComp()">
        <input type="button" class="waves-effect waves-light btn-large" value="Играть с соперником" onclick="switchToOpponent()">
        <br>
        <input type="button" class="waves-effect waves-light btn-large" value="Настройки" onclick="switchToSettingsPage()">
        <br>
        <input type="button" class="waves-effect waves-light btn-large" value="Выход" onclick="switchToExitPage()">
      `
    }

    const renderSelfGame = () => { //функция воспроизводит стартовый экран
        setBG('karta-mira2.jpg')
        return `
      `
      }

    const renderSettingsScreen = () => {
      setBG('settings.jpg');

      const backgroundGame = ['bg1.jpg', 'bg2.png', 'bg3.jpg'];

      const li = backgroundGame.reduce((acc, imgName, index) => {
        acc += `<li data-id="${index}" onclick="setBG('${imgName}')">
                    <img src="${IMG_URL}${imgName}" alt="img"/>
                </li>`

        return acc
      }, '');

      return `
        <h3>Настройки</h3>
        <div class="game-setting">
             <label>
                <input type="checkbox" />
                <span>Звук</span>
             </label>
        </div>
        <div class="game-setting">
            <p>Фон</p>
            <ul class="game-backgrounds">
                ${li}
            </ul>
        </div>
        <div class="game-setting">
            <p>Тема</p>
            <label>
                <input name="theme" type="radio" checked />
                <span>Светлая</span>
            </label>
            <label>
                <input name="theme" type="radio" />
                <span>Темная</span>
            </label>
        </div>
      `
    }

    // router
    window.onhashchange = switchToStateFromURLHash;


    function switchToStateFromURLHash() {
      const URLHash = window.location.hash || "#start-screen"; //url хэш, который ставится по умолчанию (стартовый экран)


      let pageHTML = '';

      switch (URLHash) {
        case '#start-screen':
          pageHTML += renderStartScreen();
          break;
        case '#self-game':
          pageHTML += renderSelfGame();
          break;
        case '#vsComp':
          pageHTML += "<h3>Старт</h3>";
          break;
        case '#vsOpponent':
          pageHTML += "<h3>Старт</h3>";
        break;
        case '#settings-page':
          pageHTML += renderSettingsScreen();
          break;
        case '#game-page':
          pageHTML += "<h3>Игра</h3>";
          break;
        case '#exit-page':
          pageHTML += "<h3>Выход</h3>";
          break;
      }
      document.getElementById('app').innerHTML = pageHTML;

    }

    function switchToState(newState) {
      location.hash = newState.pagename;
    }

    function switchToStartScreePage() {
      switchToState({ pagename: 'start-screen' });
    }

    function switchToSelf(url) {
      switchToState({ pagename: 'self-game' });
      const s=document.createElement("script");
        s.src=url;
        document.getElementsByTagName("head")[0].appendChild(s);
    }

    function switchToComp() {
        switchToState({ pagename: 'vsComp' });
      }

    function switchToOpponent() {
        switchToState({ pagename: 'vsOpponent' });
      }

    function switchToSettingsPage() {
      switchToState({ pagename: 'settings-page' });
    }

    function switchToGamePage() {
      switchToState({ pagename: 'game-page' });
    }

    function switchToExitPage() {
      switchToState({ pagename: 'exit-page' });
    }

    switchToStateFromURLHash();


  </script>

</body>

</html>